---
title: Linux下找回删除文件
category: Linux
layout: post
---

到现在想来，心有余悸。昨天写Shell脚本，定时备份服务器数据库，并且自动删除超过一个月的备份文件，在设置删除的rm -rf中，指定目录错误，直接定位到了用户目录下。执行时，需要的文件备份了，但灾难也就发生了，我的笔记本中的文件悄无声息的消失殆尽，不忍直视！

不管怎么样，灾难已经发生，之后要做的就是如何善后了。最近学校活动的照片都在笔记本中，这些必须要找回，dropbox里的文件到无所谓，可以还原。其他的视频什么的，没了就没了吧，还可以再下载。关键是怎么做的问题。

Linux下恢复文件有几种方法：

一是使用extundelete

在另一台Linux系统的机器上安装extundelete，然后将这块受伤的硬盘接过去，在不挂载分区的情况下，用extundelete /dev/sd?? --restore-all的形式，将删除文件全部恢复。

这是一个好办法，不过要拆机器，还要找个硬盘盒，有点麻烦，先不考虑吧。

二是使用debugfs

这种恢复方法比较简单，百度一下有教程，不过好像只能单个恢复，要是使用这种方法找回上千个文件，准会干到手抽筋。放弃！

三是使用TestDisk

不得不说，这是个宝物，和Windows下的FinalData非常像，到官网上下载，解压，然后可以直接使用。我用Photorec_static扫描恢复，80+G的Home分区恢复文件也就2个小时左右。

2个小时以后，我的那些文件又乖乖的回到了硬盘里，但是rm -rf的惊险却让我终生难忘。