---
title: 《网络程序设计案例教程》任务7.4：使用SqlDataSource对数据库进行查询
category: lesson
layout: post
---

## 教学目标

1. 掌握SqlDataSource控件的使用方法

2. 掌握数据库中视图的建立方法

3. 学会使用SqlDataSource配合Web控件对数据库进行查询

## 教学重点

掌握SqlDataSource配合Web控件对数据库进行查询的方法

## 教学难点

掌握SqlDataSource控件的使用方法

## 教学课时

2课时

## 教学过程

一、复习导入

通过上次课的学习，我们已经掌握了使用ADO.net中的DataSet来对数据库进行相应的操作。也了解了Dataset在ASP.NET中的巨大作用。今天，我们来学习另一种数据库操作的方法，那就是使用SqlDataSource控件来访问数据库。

二、概念认知

什么是SqlDataSource控件？它有什么作用？

SqlDataSource控件是ASP.NET中连接数据库的一种控件，通过它，可以使用Web控件访问位于关系数据库中的数据。SqlDataSource控件与其他显示数据的控件一起使用，就可以通过写很少的代码，完成网页程序中对于数据库的访问。

与其他控件一样，SqlDataSource控件也有着功能强大的属性与方法，在这里暂时不做介绍。因为在今天的课程中，我们几乎不用写一行代码。大家只要了解了通过这个控件可以访问数据库即可。

同样，在这里需要介绍的是SqlDataSource控件的好搭档，专门用来在网页程序中显示数据信息的控件GridView。这个控件，在上一次课的学习中，我们也已经接触到了。使用它时只需要两步：第一步，设置数据源；第二步，显示内容。

三、程序操作

本课的任务是完成课本任务3，显示选课数据库中的数据。

以下是具体操作步骤：

1.设定数据库

建立本节课需要的数据库。当然，也可以通过将建立好的数据库的脚本导出备用，这样可以快速建立数据库。

向数据库中加入相应的信息。

创建本节课所需要使用到的视图。

2.网页界面的创设

通过表格或DIV标签，对网页进行布局，向网页中拉入两个DropDownList、一个GridView和三个SqlDataSource。

这里加入SqlDataSource控件，就是为了接下来设定网页程序向数据库发出查询请求的数据源。

3.数据源配置

分别为加入的三个SqlDataSource控件配置数据源。

通过SqlDataSource1查询教师信息，通过SqlDataSource2查询DropDownList1中的信息，通过SqlDataSource3查询视图中与教师及课程相关的信息。

4.控件数据源的绑定

分别为两个DropDownList和一个GridView控件绑定数据源，并做好相应设置。

以上操作全部通过可视界面点击操作完成，直观、直接，基本不需要写代码，充分体现了SqlDataSource控件的优越性。

四、学生练习

要求学生完成课本任务。

五、课堂小结

本节课向学生们展现了查询数据库的另一种方式，直观、直接、效果好。要求学生与之前的几种方式进行对比与总结。
